<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thmyeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head th:insert="fragments/header :: header"></head>
<body>

<div th:insert="fragments/user_info :: user_info">...</div>

<div class="container">

    <div class="row">
        <h1 th:text="${game.title}"/>
        <p th:text="${game.description}"/>
    </div>
    <div class="row">
        <div class="col s2">
            <ul>
                <li th:each="gameImage : ${game.images}">
                    <img class="thumbnail" th:src="${gameImage.url}"/>
                </li>
            </ul>

            <div>
                Upload more images
                <form method="post" enctype="multipart/form-data"
                      th:action="@{'/games/' + ${game.id} + '/images'}">
                    <p><input type="file" name="file"/></p>
                    <p>
                        <button class="waves-effect waves-light btn" type="submit">Dodaj zdjęcie</button>
                    </p>
                </form>
            </div>
        </div>
        <div class="col s9 offset-s1">
            <h5>Statystyki gry</h5>
            <table class="striped">
                <tr>
                    <td>Ilość wyświetlonych reklam w sumie</td>
                    <td th:text="${views}"/>
                </tr>
                <tr>
                    <td>Średni czas widoczności reklamy</td>
                    <td th:text="${averageAdViewTime} + ' sekund'"/>
                </tr>
                <tr>
                    <td>Mediana czasu widoczności reklamy</td>
                    <td th:text="${medianAdViewTime} + ' sekund'"/>
                </tr>
            </table>
            <canvas id="myChart" width="100" height="50"></canvas>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.min.js"></script>
<script type="text/javascript" th:inline="javascript">
/*<![CDATA[*/
var ctx = document.getElementById('myChart').getContext('2d');

var myData = JSON.parse(/*[[${viewsPerHour}]]*/ '{}');
var myBarChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: ["0:00", "1:00", "2:00", "3:00", "4:00", "5:00", "6:00", "7:00", "8:00", "9:00", "10:00", "11:00",
        "12:00", "13:00", "14:00", "15:00", "16:00", "17:00", "18:00", "19:00", "20:00", "21:00", "22:00", "23:00"],
        datasets: [{
            label: 'Ilość wyświetleń o danej godzinie',
            data: myData,
            borderWidth: 1
        }]
    }
});

/*]]>*/
</script>
</body>
</html>